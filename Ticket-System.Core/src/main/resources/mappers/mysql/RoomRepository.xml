<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.apps.mybatis.mysql.RoomRepository">

    <select id="findAll" resultType="com.apps.domain.entity.Room">
        select * from room
        <where>
            <if test="search != null">
                name like concat('%',#{search},'%')
            </if>
            <if test="theater != null and search != null">
                and theater_id = #{theater}
            </if>
            <if test="theater != null">
                theater_id = #{theater}
            </if>
        </where>
        <if test="sort != null">
            order by
            <choose>
                <when test="sort == 'name'">
                    name
                </when>
                <when test="sort == 'code'">
                    code
                </when>
                <when test="sort == 'theaterId'">
                    theater_id
                </when>
                <otherwise>
                    type
                </otherwise>
<!--                <when test="sort == 'latitude'">-->
<!--                    latitude-->
<!--                </when>-->
<!--                <otherwise>-->
<!--                    longitude-->
<!--                </otherwise>-->
            </choose>
        </if>

        <if test="order != 'ASC' and sort != null" >
            DESC
        </if>
        limit #{limit} offset #{offset}
    </select>

<!--    <insert id="insert" useGeneratedKeys="true" keyProperty="com.apps.domain.entity.Room.id">-->
<!--        INSERT INTO booksystem.room (code, name, theater_id)-->
<!--        VALUES (#{room.code},#{room.name},#{room.theaterId})-->
<!--        <selectKey keyProperty="id" order="AFTER" resultType="int" statementType="PREPARED" >-->
<!--            SELECT LAST_INSERT_ID();-->
<!--        </selectKey>-->
<!--    </insert>-->

</mapper>